(window.webpackJsonpfrontend=window.webpackJsonpfrontend||[]).push([[0],{31:function(e,t,n){e.exports=n(82)},36:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(16),c=n.n(r),o=(n(36),n(10)),i=n(8),u=n(2),s=n(7),m=n.n(s),d=Object(a.createContext)(),E=(n(54),function(){var e=Object(a.useState)(!0),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(d),o=Object(a.useRef)(null),i=Object(a.useRef)(null);return l.a.createElement("form",{className:"auth-form",onSubmit:function(e){e.preventDefault();var t=o.current.value,a=i.current.value;if(0!==t.trim().length&&0!==a.trim().length){var l={query:"\n        query Login($email: String!, $password: String!) {\n          login(email: $email, password: $password) {\n            userId\n            token\n            tokenExpiration\n          }\n        }\n      ",variables:{email:t,password:a}};n||(l={query:"\n          mutation CreateUser($email: String!, $password: String!) {\n            createUser(userInput: {email: $email, password: $password}) {\n              _id\n              email\n            }\n          }\n        ",variables:{email:t,password:a}}),m.a.post("http://localhost:5000/graphql",l).then((function(e){var t=e.data.data.login,a=t.token,l=t.userId,r=t.tokenExpiration;n&&a&&c.login(a,l,r),console.log(e)})).catch((function(e){console.log(e,e.data)}))}}},l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"email"},"E-mail"),l.a.createElement("input",{type:"email",id:"email",ref:o})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement("input",{type:"password",id:"password",ref:i})),l.a.createElement("div",{className:"form-actions"},l.a.createElement("button",{type:"submit"},"Submit"),l.a.createElement("button",{type:"button",onClick:function(){r(!n)}},"Switch to ",n?"Signup":"Login")))}),f=n(13),p=(n(55),function(e){return l.a.createElement("div",{className:"modal"},l.a.createElement("header",{className:"modal__header"},l.a.createElement("h1",null,e.title)),l.a.createElement("section",{className:"modal__content"},e.children),l.a.createElement("section",{className:"modal__actions"},e.canCancel&&l.a.createElement("button",{className:"btn",onClick:e.onCancel},"Cancel"),e.canConfirm&&l.a.createElement("button",{className:"btn",onClick:e.onConfirm},e.confirmText)))}),v=(n(56),function(e){return l.a.createElement("div",{className:"backdrop"})}),b=(n(57),function(e){return l.a.createElement("li",{key:e.eventId,className:"events__list-item"},l.a.createElement("div",null,l.a.createElement("h1",null,e.title),l.a.createElement("h2",null,"$",e.price," - ",new Date(e.date).toLocaleDateString())),l.a.createElement("div",null,e.userId===e.creatorId?l.a.createElement("p",null,"Your the owner of this event."):l.a.createElement("button",{className:"btn",onClick:e.onDetail.bind(void 0,e.eventId)},"View Details")))}),h=(n(58),function(e){var t=e.events.map((function(t){return l.a.createElement(b,{key:t._id,eventId:t._id,title:t.title,price:t.price,date:t.date,userId:e.authUserId,creatorId:t.creator._id,onDetail:e.onViewDetail})}));return l.a.createElement("ul",{className:"event__list"},t)}),g=(n(59),function(){return l.a.createElement("div",{className:"spinner"},l.a.createElement("div",{className:"lds-dual-ring"}))}),k=(n(60),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),o=Object(u.a)(c,2),i=o[0],s=o[1],E=Object(a.useState)(!1),b=Object(u.a)(E,2),k=b[0],C=b[1],O=Object(a.useState)(null),_=Object(u.a)(O,2),j=_[0],N=_[1],w=Object(a.useRef)(!0),y=Object(a.useContext)(d),S=Object(a.useRef)(null),x=Object(a.useRef)(null),I=Object(a.useRef)(null),$=Object(a.useRef)(null),D=function(){r(!1),N(null)};return Object(a.useEffect)((function(){return function(){C(!0);m.a.post("http://localhost:5000/graphql",{query:"\n          query {\n            events {\n              _id\n              title\n              description\n              date\n              price\n              creator {\n                _id\n                email\n              }\n            }\n          }\n        "},{headers:{Authorization:"Bearer "+y.token}}).then((function(e){var t=e.data.data.events;s(t),C(!1)})).catch((function(e){console.log(e),w&&C(!1)}))}(),w.current=!0,function(){w.current=!1}}),[]),l.a.createElement(l.a.Fragment,null,(n||j)&&l.a.createElement(v,null),n&&l.a.createElement(p,{title:"Add Event",canCancel:!0,canConfirm:!0,onCancel:D,onConfirm:function(){r(!1);var e=S.current.value,t=+x.current.value,n=I.current.value,a=$.current.value;if(!(0===e.trim().length||t<=0||0===n.trim().length||0===a.trim().length)){var l={title:e,price:t,date:n,description:a};console.log(l);var c={query:"\n          mutation CreateEvent($title: String!, $desc: String!, $price: Float!, $date: String!) {\n            createEvent(eventInput: {title: $title, description: $desc, price: $price, date: $date}) {\n              _id\n              title\n              description\n              date\n              price\n            }\n          }\n        ",variables:{title:e,desc:a,price:t,date:n}};m.a.post("http://localhost:5000/graphql",c,{headers:{Authorization:"Bearer "+y.token}}).then((function(e){s((function(t){var n=Object(f.a)(t);return n.push({_id:e.data.data.createEvent._id,title:e.data.data.createEvent.title,description:e.data.data.createEvent.description,date:e.data.data.createEvent.date,price:e.data.data.createEvent.price,creator:{_id:y.userId}}),n}))})).catch((function(e){console.log(e)}))}},confirmText:"Confirm"},l.a.createElement("form",null,l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"title"},"Title"),l.a.createElement("input",{type:"text",id:"title",ref:S})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"price"},"Price"),l.a.createElement("input",{type:"number",id:"price",ref:x})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"date"},"Date"),l.a.createElement("input",{type:"datetime-local",id:"date",ref:I})),l.a.createElement("div",{className:"form-control"},l.a.createElement("label",{htmlFor:"description"},"Description"),l.a.createElement("textarea",{id:"description",rows:"4",ref:$})))),j&&l.a.createElement(p,{title:j.title,canCancel:!0,canConfirm:!0,onCancel:D,onConfirm:function(){if(y.token){var e={query:"\n          mutation BookEvent($id: ID!) {\n            bookEvent(eventId: $id) {\n              _id\n             createdAt\n             updatedAt\n            }\n          }\n        ",variables:{id:j._id}};m.a.post("http://localhost:5000/graphql",e,{headers:{Authorization:"Bearer "+y.token}}).then((function(e){N(null)})).catch((function(e){console.log(e)}))}else N(null)},confirmText:y.token?"Book":"Confirm"},l.a.createElement("h1",null,j.title),l.a.createElement("h2",null,"$",j.price," -"," ",new Date(j.date).toLocaleDateString()),l.a.createElement("p",null,j.description)),y.token&&l.a.createElement("div",{className:"events-control"},l.a.createElement("p",null,"Share your own Events!"),l.a.createElement("button",{className:"btn",onClick:function(){r(!0)}},"Create Event")),k?l.a.createElement(g,null):l.a.createElement(h,{events:i,authUserId:y.userId,onViewDetail:function(e){var t=i.find((function(t){return t._id===e}));N(t)}}))}),C=(n(61),function(e){return l.a.createElement("ul",{className:"bookings__list"},e.bookings.map((function(t){return l.a.createElement("li",{key:t._id,className:"bookings__item"},l.a.createElement("div",{className:"bookings__item-data"},t.event.title," -"," ",new Date(t.createdAt).toLocaleDateString()),l.a.createElement("div",{className:"bookings__item-actions"},l.a.createElement("button",{className:"btn",onClick:e.onDelete.bind(void 0,t._id)},"Cancel")))})))}),O=n(28),_={Cheap:{min:0,max:100},Normal:{min:100,max:200},Expensive:{min:200,max:1e7}},j=function(e){var t={labels:[],datasets:[]},n=[],a=function(a){var l=e.bookings.reduce((function(e,t){return t.event.price>_[a].min&&t.event.price<_[a].max?e+1:e}),0);n.push(l),t.labels.push(a),t.datasets.push({fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:n}),(n=Object(f.a)(n))[n.length-1]=0};for(var r in _)a(r);return l.a.createElement("div",{style:{textAlign:"center"}},l.a.createElement(O.Bar,{data:t}))},N=(n(74),function(e){return l.a.createElement("div",{className:"bookings-control"},l.a.createElement("button",{className:"list"===e.activeOutputType?"active":"",onClick:e.onChange.bind(void 0,"list")},"List"),l.a.createElement("button",{className:"chart"===e.activeOutputType?"active":"",onClick:e.onChange.bind(void 0,"chart")},"Chart"))}),w=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),o=Object(u.a)(c,2),i=o[0],s=o[1],E=Object(a.useState)("list"),f=Object(u.a)(E,2),p=f[0],v=f[1],b=Object(a.useContext)(d);Object(a.useEffect)((function(){h()}),[]);var h=function(){r(!0);m.a.post("http://localhost:5000/graphql",{query:"\n          query {\n            bookings {\n              _id\n             createdAt\n             event {\n               _id\n               title\n               date\n               price\n             }\n            }\n          }\n        "},{headers:{Authorization:"Bearer "+b.token}}).then((function(e){var t=e.data.data.bookings;s(t),r(!1)})).catch((function(e){console.log(e),r(!1)}))},k=l.a.createElement(g,null);return n||(k=l.a.createElement(l.a.Fragment,null,l.a.createElement(N,{activeOutputType:p,onChange:function(e){v("list"===e?"list":"chart")}}),l.a.createElement("div",null,"list"===p?l.a.createElement(C,{bookings:i,onDelete:function(e){r(!0);var t={query:"\n         mutation CancelBooking($id: ID!) {\n          cancelBooking(bookingId: $id) {\n            _id\n             title\n            }\n          }\n        ",variables:{id:e}};m.a.post("http://localhost:5000/graphql",t,{headers:{Authorization:"Bearer "+b.token}}).then((function(t){s((function(t){return t.filter((function(t){return t._id!==e}))})),r(!1)})).catch((function(e){console.log(e),r(!1)}))}}):l.a.createElement(j,{bookings:i})))),l.a.createElement(l.a.Fragment,null,k)},y=(n(75),function(e){var t=Object(a.useContext)(d);return l.a.createElement("header",{className:"main-navigation"},l.a.createElement("div",{className:"main-navigation__logo"},l.a.createElement("h1",null,"LODI")),l.a.createElement("nav",{className:"main-navigation__items"},l.a.createElement("ul",null,!t.token&&l.a.createElement("li",null,l.a.createElement(o.b,{to:"/auth"},"Authenticate")),l.a.createElement("li",null,l.a.createElement(o.b,{to:"/events"},"Events")),t.token&&l.a.createElement(l.a.Fragment,null,l.a.createElement("li",null,l.a.createElement(o.b,{to:"/bookings"},"Bookings")),l.a.createElement("li",null,l.a.createElement("button",{onClick:t.logout},"Logout"))))))}),S=(n(81),function(){var e=Object(a.useContext)(d);return l.a.createElement(o.a,null,l.a.createElement(y,null),l.a.createElement("main",{className:"main-content"},l.a.createElement(i.d,null,e.token&&l.a.createElement(i.a,{from:"/",to:"/events",exact:!0}),e.token&&l.a.createElement(i.a,{from:"/auth",to:"/events",exact:!0}),!e.token&&l.a.createElement(i.b,{path:"/auth",component:E}),l.a.createElement(i.b,{path:"/events",component:k}),e.token&&l.a.createElement(i.b,{path:"/bookings",component:w}),!e.token&&l.a.createElement(i.a,{to:"/auth",exact:!0}))))});c.a.render(l.a.createElement((function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(null),i=Object(u.a)(o,2),s=i[0],m=i[1];return l.a.createElement(d.Provider,{value:{token:r,userId:s,login:function(e,t,n){c(e),m(t)},logout:function(){c(null),m(null)}}},e.children)}),null,l.a.createElement(S,null)),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.40cf84e4.chunk.js.map